import { PolymerElement } from '@polymer/polymer/polymer-element.js';
import { LightDomHelper } from './vaadin-light-dom-helper.js';
import { ThemableMixin } from '@vaadin/vaadin-themable-mixin/vaadin-themable-mixin.js';
import { html } from '@polymer/polymer/lib/utils/html-tag.js';
let instanceIndex = 0;
class VaadinDemoShadowDomRenderer extends ThemableMixin(PolymerElement) {
  static get template() {
    return html`
    <style>
      :host {
        display: block;
        padding: 1.5em;
      }
    </style>
`;
  }

  static get is() {
    return 'vaadin-demo-shadow-dom-renderer';
  }

  static get properties() {
    return {
      id: {
        type: String,
        value: () => {
          return `vaadin-demo-shadow-dom-${instanceIndex++}`;
        }
      },
    };
  }

  ready() {
    super.ready();
    LightDomHelper.querySelectorAsync('slot', this)
      .then(slot => {
        return LightDomHelper.querySlotContentAsync('template', slot);
      })
      .then(template => {
        this._showDemo(template);
      })
      .catch(error => {
        throw new Error('vaadin-demo-iframe-renderer requires a <template> child');
      });
  }

  _showDemo(template) {
    window.ShadyCSS.prepareTemplate(template, this.id);
    const dom = this.getRootNode().host._stampTemplate(template);
    this.shadowRoot.appendChild(dom);
  }
}
customElements.define(VaadinDemoShadowDomRenderer.is, VaadinDemoShadowDomRenderer);
